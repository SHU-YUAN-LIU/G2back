import{M as w}from"./MainHeader-2mvpkKEJ.js";import{D as y}from"./Dropdown-guM0ol81.js";import{S as D}from"./switch_btn-ZhaqtYx3.js";import{S as v}from"./SearchBtn--XR7Df41.js";import{L as S}from"./Lightbox-fV0nRl0Y.js";import{_ as M}from"./icon_revise-Pz_rOds_.js";import{_ as L,c as d,e as i,b as t,F as _,f as k,w as B,r as c,o as m,t as n,d as A}from"./index-RZyxdeL6.js";import"./logo-99sjnrK6.js";const I={components:{MainHeader:w,Dropdown:y,switch_btn:D,SearchBtn:v,Lightbox:S},data(){return{placeholder:"會員ID或電話",memberdata:[],currentlightbox:[],memberstatus:""}},created(){this.getMemberData()},mounted(){document.title="青年進補黨(後台) - 會員管理"},methods:{showLightbox(s){this.$refs.lightbox.showLightbox=!0,this.currentlightbox=this.memberdata.filter(e=>e.member_no==s)},getMemberData(){this.memberdata=[],this.currentlightbox=[],fetch("https://tibamef2e.com/chd104/g2/back/memberDataGetAll.php").then(e=>e.json()).then(e=>{const r=e.members;this.showMembers(r)}).catch(e=>{console.log(e)})},showMembers(s){for(let e=0;e<s.length;e++)s[e].status=="A"?this.memberstatus="正常":this.memberstatus="停用",this.memberdata.push({member_no:s[e].member_no,member_name:s[e].member_name,cellphone:s[e].cellphone,phone:s[e].phone,birthday:s[e].birthday,email:s[e].email,password:s[e].password,address:s[e].address,id_number:s[e].id_number,point:s[e].point,modifier:s[e].modifier,modify_date:s[e].modify_date,create_date:s[e].create_date,status:this.memberstatus})},changeMemberStatus(s){const e=this.memberdata.find(r=>r.member_no===s);if(e){e.status=e.status==="正常"?"停用":"正常",e.status=="正常"?this.memberstatus="A":this.memberstatus="IA",e.modify_date=new Date().toLocaleString();let r={member_no:s,status:this.memberstatus};fetch("https://tibamef2e.com/chd104/g2/back/memberDataUpdate.php",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(r)}).then(o=>o.json()).catch(o=>console.log(o))}},updateData(s){document.getElementById("member_status").value=="正常"?this.memberstatus="A":this.memberstatus="IA";let e={member_no:s,status:this.memberstatus};fetch("https://tibamef2e.com/chd104/g2/back/memberDataUpdate.php",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(l=>l.json()).then(l=>{l.error||(alert(l.msg),this.$refs.lightbox.showLightbox=!1,this.getMemberData())}).catch(l=>console.log(l))}}},C={class:"mem-bg"},j={class:"mem_wrap-group"},N={class:"mem_wrap"},T={class:"mem-info"},V={class:"table"},E=t("thead",null,[t("tr",{class:"table-dark",align:"center "},[t("th",{scope:"col",class:"p-3"},"會員ID"),t("th",{scope:"col",class:"p-2"},[t("span",{class:"l-2"},"姓名")]),t("th",{scope:"col",class:"p-2"},"連絡電話"),t("th",{scope:"col",class:"p-2"},"狀態正常"),t("th",{scope:"col",class:"p-2"},"操作")])],-1),H={id:"memberTbody"},F={align:"center"},J={class:"align-middle"},O={class:"align-middle"},U={class:"align-middle"},G={class:"align-middle"},q={class:"align-middle"},z=["onClick"],K=t("img",{src:M,alt:""},null,-1),P={class:"admin_lightbox",style:{"overflow-y":"scroll"}},Q=t("span",null,"建立日期: ",-1),R=t("span",null,"修改日期: ",-1),W=t("p",{class:"title"},[t("span",null,"詳細資訊")],-1),X=t("td",null,"會員ID:",-1),Y=t("td",null,"姓名:",-1),Z=t("td",null,"生日:",-1),$=t("td",null,"地址:",-1),tt=t("td",null,"行動電話:",-1),et=t("td",null,"室內電話:",-1),st=t("td",null,"EMAIL:",-1),ot=t("td",null,"密碼:",-1),nt=t("td",null,"狀態:",-1),lt=["value"],rt=t("option",{value:"正常"},"正常",-1),at=t("option",{value:"停用"},"停用",-1),it=[rt,at],ct=t("td",null,"點數:",-1);function ht(s,e,r,l,o,h){const u=c("MainHeader"),b=c("Dropdown"),p=c("SearchBtn"),g=c("switch_btn"),f=c("Lightbox");return m(),d(_,null,[i(u),i(b),t("div",C,[t("div",j,[t("div",N,[i(p,{placeholder:o.placeholder},null,8,["placeholder"]),t("div",T,[t("table",V,[E,t("tbody",H,[(m(!0),d(_,null,k(o.memberdata,a=>(m(),d("tr",F,[t("td",J,n(a.member_no),1),t("td",O,n(a.member_name),1),t("td",U,n(a.cellphone),1),t("td",G,[i(g,{ischecked:a.status=="正常",onChange:x=>h.changeMemberStatus(a.member_no)},null,8,["ischecked","onChange"])]),t("td",q,[t("button",{class:"showlightbtn",onClick:x=>h.showLightbox(a.member_no)},[K,A("修改 ")],8,z)])]))),256))])])])])])]),i(f,{class:"memberlightbox",onToSaveData:e[0]||(e[0]=a=>h.updateData(o.currentlightbox[0].member_no)),lightboxType:"true",ref:"lightbox"},{default:B(()=>[t("div",P,[t("p",null,[Q,t("span",null,n(o.currentlightbox[0].create_date),1)]),t("p",null,[R,t("span",null,n(o.currentlightbox[0].modify_date),1)]),W,t("table",null,[t("tr",null,[X,t("td",null,n(o.currentlightbox[0].member_no),1)]),t("tr",null,[Y,t("td",null,n(o.currentlightbox[0].member_name),1)]),t("tr",null,[Z,t("td",null,n(o.currentlightbox[0].birthday),1)]),t("tr",null,[$,t("td",null,n(o.currentlightbox[0].address),1)]),t("tr",null,[tt,t("td",null,n(o.currentlightbox[0].cellphone),1)]),t("tr",null,[et,t("td",null,n(o.currentlightbox[0].phone),1)]),t("tr",null,[st,t("td",null,n(o.currentlightbox[0].email),1)]),t("tr",null,[ot,t("td",null,n(o.currentlightbox[0].password),1)]),t("tr",null,[nt,t("td",null,[t("select",{id:"member_status",value:o.currentlightbox[0].status},it,8,lt)])]),t("tr",null,[ct,t("td",null,n(o.currentlightbox[0].point),1)])])])]),_:1},512)],64)}const xt=L(I,[["render",ht]]);export{xt as default};
