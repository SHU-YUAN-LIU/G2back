import{M as x}from"./MainHeader-DaECsDNK.js";import{D as w}from"./Dropdown-wKLv1o-f.js";import{S as y}from"./switch_btn-sewhvX3e.js";import{S as D}from"./SearchBtn-Pw_UUlD6.js";import{L as v}from"./Lightbox-V-q3mddi.js";import{_ as S}from"./icon_revise-Pz_rOds_.js";import{_ as M,c as d,e as i,b as t,F as u,f as L,w as B,r as c,o as m,t as l,d as k}from"./index-ZmuxTH6k.js";import"./logo-99sjnrK6.js";const A={components:{MainHeader:x,dropDown:w,switch_btn:y,SearchBtn:D,Lightbox:v},data(){return{placeholder:"會員ID或電話",memberdata:[],currentlightbox:[],memberstatus:""}},created(){this.getMemberData()},mounted(){document.title="青年進補黨(後台) - 會員管理"},methods:{showLightbox(s){this.$refs.lightbox.showLightbox=!0,this.currentlightbox=this.memberdata.filter(e=>e.member_no==s)},getMemberData(){this.memberdata=[],this.currentlightbox=[],fetch("https://tibamef2e.com/chd104/g2/php/memberDataGetAll.php").then(e=>e.json()).then(e=>{const n=e.members;console.log(111,n),this.showMembers(n)}).catch(e=>{console.log(e)})},showMembers(s){for(let e=0;e<s.length;e++)s[e].status=="A"?this.memberstatus="正常":this.memberstatus="停用",this.memberdata.push({member_no:s[e].member_no,member_name:s[e].member_name,cellphone:s[e].cellphone,phone:s[e].phone,birthday:s[e].birthday,email:s[e].email,password:s[e].password,address:s[e].address,id_number:s[e].id_number,point:s[e].point,modifier:s[e].modifier,modify_date:s[e].modify_date,create_date:s[e].create_date,status:this.memberstatus})},changeMemberStatus(s){const e=this.memberdata.find(n=>n.member_no===s);if(e){e.status=e.status==="正常"?"停用":"正常",e.status=="正常"?this.memberstatus="A":this.memberstatus="IA",e.modify_date=new Date().toLocaleString();let n={member_no:s,status:this.memberstatus};fetch("https://tibamef2e.com/chd104/g2/php/memberDataUpdate.php",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(n)}).then(o=>o.json()).catch(o=>console.log(o))}},updateData(s){document.getElementById("member_status").value=="正常"?this.memberstatus="A":this.memberstatus="IA";let e={member_no:s,status:this.memberstatus};fetch("https://tibamef2e.com/chd104/g2/php/memberDataUpdate.php",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(r=>r.json()).then(r=>{r.error||(alert(r.msg),this.$refs.lightbox.showLightbox=!1,this.getMemberData())}).catch(r=>console.log(r))}}},I={class:"mem-bg"},C={class:"mem_wrap-group"},j={class:"mem_wrap"},N={class:"mem-info"},T={class:"table"},V=t("thead",null,[t("tr",{class:"table-dark",align:"center "},[t("th",{scope:"col",class:"p-3"},"會員ID"),t("th",{scope:"col",class:"p-2"},[t("span",{class:"l-2"},"姓名")]),t("th",{scope:"col",class:"p-2"},"連絡電話"),t("th",{scope:"col",class:"p-2"},"狀態正常"),t("th",{scope:"col",class:"p-2"},"操作")])],-1),E={id:"memberTbody"},H={align:"center"},F={class:"align-middle"},J={class:"align-middle"},O={class:"align-middle"},U={class:"align-middle"},G={class:"align-middle"},q=["onClick"],z=t("img",{src:S,alt:""},null,-1),K={class:"admin_lightbox",style:{"overflow-y":"scroll"}},P=t("span",null,"建立日期: ",-1),Q=t("span",null,"修改日期: ",-1),R=t("p",{class:"title"},[t("span",null,"詳細資訊")],-1),W=t("td",null,"會員ID:",-1),X=t("td",null,"姓名:",-1),Y=t("td",null,"生日:",-1),Z=t("td",null,"地址:",-1),$=t("td",null,"行動電話:",-1),tt=t("td",null,"室內電話:",-1),et=t("td",null,"EMAIL:",-1),st=t("td",null,"密碼:",-1),ot=t("td",null,"狀態:",-1),lt=["value"],nt=t("option",{value:"正常"},"正常",-1),rt=t("option",{value:"停用"},"停用",-1),at=[nt,rt],it=t("td",null,"點數:",-1);function ct(s,e,n,r,o,h){const _=c("MainHeader"),p=c("SearchBtn"),b=c("switch_btn"),g=c("Lightbox");return m(),d(u,null,[i(_),t("div",I,[t("div",C,[t("div",j,[i(p,{placeholder:o.placeholder},null,8,["placeholder"]),t("div",N,[t("table",T,[V,t("tbody",E,[(m(!0),d(u,null,L(o.memberdata,a=>(m(),d("tr",H,[t("td",F,l(a.member_no),1),t("td",J,l(a.member_name),1),t("td",O,l(a.cellphone),1),t("td",U,[i(b,{ischecked:a.status=="正常",onChange:f=>h.changeMemberStatus(a.member_no)},null,8,["ischecked","onChange"])]),t("td",G,[t("button",{class:"showlightbtn",onClick:f=>h.showLightbox(a.member_no)},[z,k("修改 ")],8,q)])]))),256))])])])])])]),i(g,{class:"memberlightbox",onToSaveData:e[0]||(e[0]=a=>h.updateData(o.currentlightbox[0].member_no)),lightboxType:"true",ref:"lightbox"},{default:B(()=>[t("div",K,[t("p",null,[P,t("span",null,l(o.currentlightbox[0].create_date),1)]),t("p",null,[Q,t("span",null,l(o.currentlightbox[0].modify_date),1)]),R,t("table",null,[t("tr",null,[W,t("td",null,l(o.currentlightbox[0].member_no),1)]),t("tr",null,[X,t("td",null,l(o.currentlightbox[0].member_name),1)]),t("tr",null,[Y,t("td",null,l(o.currentlightbox[0].birthday),1)]),t("tr",null,[Z,t("td",null,l(o.currentlightbox[0].address),1)]),t("tr",null,[$,t("td",null,l(o.currentlightbox[0].cellphone),1)]),t("tr",null,[tt,t("td",null,l(o.currentlightbox[0].phone),1)]),t("tr",null,[et,t("td",null,l(o.currentlightbox[0].email),1)]),t("tr",null,[st,t("td",null,l(o.currentlightbox[0].password),1)]),t("tr",null,[ot,t("td",null,[t("select",{id:"member_status",value:o.currentlightbox[0].status},at,8,lt)])]),t("tr",null,[it,t("td",null,l(o.currentlightbox[0].point),1)])])])]),_:1},512)],64)}const ft=M(A,[["render",ct]]);export{ft as default};
